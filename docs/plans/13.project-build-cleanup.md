# Plan 13: Project Build Cleanup

## 1. Objective

To achieve a clean, functional production build by eliminating all build-time warnings and optimizing the final CSS assets. This plan consolidates and replaces the previous `11.sass-slash-div-migration.md` and `12.sass-deprecation-fixes.md`, and also documents the addition of `PurgeCSS`.

---

## 2. Execution Plan

### Part A: CSS Asset Optimization (Completed)

This step ensures that the production build is as small as possible by removing unused CSS.

-   **Task:** Add and configure `@fullhuman/postcss-purgecss` to the Nuxt build process.
-   **Details:** The configuration was added to `nuxt.config.js` to scan `.vue` and `.js` files and remove any unused CSS classes from the final build artifacts in the `dist/` directory.
-   **Status:** âœ… **Completed**

### Part B: Sass Deprecation Fixes (Pending)

This multi-step process will eliminate all Sass-related deprecation warnings from the build output.

#### Step 1: Fix `slash-div` Warning

-   **Warning:** `DEPRECATION WARNING [slash-div]`
-   **Action:** Use the official `sass-migrator` to automatically convert the deprecated `/` division syntax to the modern `math.div()` function.
-   **Command:** `npx sass-migrator division <file>` for each relevant `.scss` file.

#### Step 2: Migrate from `@import` to `@use`

-   **Warning:** `DEPRECATION WARNING [import]`
-   **Action:** Use the official `sass-migrator` to convert all `@import` rules to the modern `@use` syntax. This is a critical step that enables proper namespacing.
-   **Command:** `npx sass-migrator module --migrate-deps .`

#### Step 3: Fix Namespaced Function Calls

-   **Warnings:** `DEPRECATION WARNING [global-builtin]`, `DEPRECATION WARNING [color-functions]`
-   **Action:** After migrating to `@use`, the build will likely fail because global functions like `lighten()` and `percentage()` will no longer be available. These will be manually updated to their new, namespaced equivalents (e.g., `color.adjust()`, `math.percentage()`).
-   **Files to Watch:** `assets/css/utilities/_functions.scss`, `assets/css/base/_grid.scss`.

#### Step 4: Investigate Legacy JS API Warning

-   **Warning:** `DEPRECATION WARNING [legacy-js-api]`
-   **Action:** This warning is likely related to the Sass loader version used by Nuxt 2. If it persists after all other fixes, it will be investigated separately. It may not be fixable without a major dependency upgrade, but it does not break the build.

## 3. Verification

After each step in Part B, the build will be run using `npm run build` to confirm that the targeted warnings have been resolved. After all steps are complete, a final visual check of the application will be performed to ensure no styles have been broken.
